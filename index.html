<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>LIFF userId Demo</title>

  <!-- ①  載入 LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <style>
    body{font-family:sans-serif;text-align:center;padding:2rem;}
    button{padding:.6rem 1.4rem;font-size:1rem;border:none;border-radius:8px;
      background:#06c755;color:#fff;}
  </style>
</head>
<body>
  <h1>LIFF userId Demo</h1>
  <p id="uid">initialising…</p>
  <button id="sendBtn" style="display:none;">一鍵詢價</button>

  <script>
    // ②  把下行改成你在 LINE Console 產生的 liffId（數字字串）
    const liffId = 'LIFF_ID_HERE';

    async function init() {
      /* ③ 初始化 */
      await liff.init({ liffId });

      /* ④ 未登入就導向登入 */
      if (!liff.isLoggedIn()) {
        return liff.login({ redirectUri: location.href });
      }

      /* ⑤ 取得個人資料 → userId */
      const profile = await liff.getProfile();
      const uid = profile.userId;
      document.getElementById('uid').textContent = '你的 userId：' + uid;

      /* ⑥ 顯示「一鍵詢價」示範按鈕 */
      const btn = document.getElementById('sendBtn');
      btn.style.display = 'inline-block';
      btn.onclick = async () => {
        await liff.sendMessages([
          { type:'text', text:`我要詢價 (uid=${uid})` }
        ]);
        alert('訊息已送出！');
        liff.closeWindow();
      };
    }
    init().catch(err => {
      document.getElementById('uid').textContent = '初始化失敗：' + err;
      console.error(err);
    });
  </script>
</body>
</html>
